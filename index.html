<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <title>Unemployment Bubble Chart</title>
  <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>
  <div id="container" class="svg-container"></div>
  <script src='//d3js.org/d3.v4.min.js'></script>
  <script src="//d3js.org/topojson.v1.min.js"></script>

  <script>
    var dataReady = function(error, states) {
      if (error) throw error;
      var _states = states;
      renderMap(_states);
    }

    var renderMap = function(states) {
      svg.selectAll('*').remove(); // clear for re-render
      
      svg.selectAll('.states')
        .data(topojson.feature(states, states.objects.states).features)
        .enter()
        .append('path')
        .attr('class', 'state')
        .attr('d', path)
    }

    var svg = d3.select('#container').append('svg')
      .attr('xmlns', 'http://www.w3.org/2000/svg')
      .attr('version', '1.1')
      .attr('viewBox', '0 0 900 500')
      .attr('preserveAspectRatio', 'xMidYMid meet')
      .classed('svg-content', true);

    var projection = d3.geoAlbersUsa();
    var path = d3.geoPath().projection(projection);

    d3.queue()
      .defer(d3.json, 'data/us-states-simplified.json')
      .await(dataReady);

  </script>
</body>
</html>
